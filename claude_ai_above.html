<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€êµ¬ ë¬¼ë¦¬í•™ì  ê³„ì‚°ê¸°</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #555;
            margin: 25px 0 15px 0;
            padding-bottom: 5px;
            border-bottom: 2px solid #eee;
        }
        .input-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .input-group label {
            min-width: 200px;
            font-weight: 500;
            color: #555;
        }
        .input-group input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        .unit {
            min-width: 40px;
            color: #666;
            font-size: 14px;
        }
        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        .calculate-btn:hover {
            transform: translateY(-2px);
        }
        .results {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .result-label {
            font-weight: 500;
            color: #555;
        }
        .result-value {
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="https://pr0t0ss1005.github.io/gravity.github.io/" class="button">BACK</a>
        <h2>ğŸŒ ì§€êµ¬ ë¬¼ë¦¬í•™ì  ê³„ì‚°ê¸°(ì§€êµ¬ìƒê³µ)</h2>
        <div class="section-title">ì§€êµ¬ íƒ€ì›ì²´ ì •ë³´</div>
        <div class="input-group">
            <label for="semiMajorAxis">ì¥ë°˜ì¶• (Semi-Major Axis):</label>
            <input type="number" id="semiMajorAxis" placeholder="6378137.0" step="0.001">
            <span class="unit">m</span>
        </div>

        <div class="input-group">
            <label for="semiMinorAxis">ë‹¨ë°˜ì¶• (Semi-Minor Axis):</label>
            <input type="number" id="semiMinorAxis" placeholder="6356752.314245" step="0.001">
            <span class="unit">m</span>
        </div>

        <div class="section-title">ìœ„ì¹˜ ì •ë³´</div>
        <div class="input-group">
            <label for="latitude">ìœ„ë„ (Latitude):</label>
            <input type="number" id="latitude" placeholder="37.5665" step="0.000001">
            <span class="unit">Â°</span>
        </div>

        <div class="input-group">
            <label for="longitude">ê²½ë„ (Longitude):</label>
            <input type="number" id="longitude" placeholder="126.9780" step="0.000001">
            <span class="unit">Â°</span>
        </div>

        <div class="input-group">
            <label for="height">ì§€ë©´ì˜ íƒ€ì›ì²´ ë†’ì´:</label>
            <input type="number" id="height" placeholder="150.0" step="0.001">
            <span class="unit">m</span>
        </div>

        <div class="input-group">
            <label for="altitude">ê³ ë„:</label>
            <input type="number" id="altitude" placeholder="0.0" step="0.1">
            <span class="unit">m</span>
        </div>

        <div class="section-title">ë°€ë„ ì •ë³´</div>
        <div class="input-group">
            <label for="earthDensity">ì§€êµ¬ í‰ê·  ë°€ë„:</label>
            <input type="number" id="earthDensity" placeholder="5513.0" step="0.01">
            <span class="unit">kg/mÂ³</span>
        </div>

        <div class="input-group">
            <label for="atmDensity">ëŒ€ê¸° ë°€ë„:</label>
            <input type="number" id="atmDensity" placeholder="1.225" step="0.001">
            <span class="unit">kg/mÂ³</span>
        </div>

        <button class="calculate-btn" onclick="calculateResults()">ğŸ”¬ ê³„ì‚°í•˜ê¸°</button>

        <div id="results" class="results" style="display: none;">
            <div class="section-title">ğŸ“Š ê³„ì‚° ê²°ê³¼</div>
            <div id="resultContent"></div>
        </div>
    </div>

    <script>
        function calculateResults() {
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸° - altitude ID ìˆ˜ì •
            const a = parseFloat(document.getElementById('semiMajorAxis').value) || 6378137.0;
            const b = parseFloat(document.getElementById('semiMinorAxis').value) || 6356752.314245;
            const lat = parseFloat(document.getElementById('latitude').value) || 37.5665;
            const lon = parseFloat(document.getElementById('longitude').value) || 126.9780;
            const h = parseFloat(document.getElementById('height').value) || 150.0;
            const alt = parseFloat(document.getElementById('altitude').value) || 0.0; // ìˆ˜ì •ë¨
            const earthDensity = parseFloat(document.getElementById('earthDensity').value) || 5513.0;
            const atmDensity = parseFloat(document.getElementById('atmDensity').value) || 1.225;

            // ë””ë²„ê¹…ì„ ìœ„í•œ ì½˜ì†” ì¶œë ¥
            console.log('Input values:', { a, b, lat, lon, h, alt, earthDensity, atmDensity });

            // ê³„ì‚° ìˆ˜í–‰
            const results = performCalculations(a, b, lat, lon, h, alt, earthDensity, atmDensity);

            // ê²°ê³¼ í‘œì‹œ
            displayResults(results);
        }

        function deg2rad(deg) {
            return deg * (Math.PI / 180);
        }

        function performCalculations(a, b, lat, lon, h, alt, earthDensity, atmDensity) {
            // ê°ë„ë¥¼ ë¼ë””ì•ˆìœ¼ë¡œ ë³€í™˜
            const latRad = lat * Math.PI / 180;
            const lonRad = lon * Math.PI / 180;
            
            // ì´ì‹¬ë¥  ê³„ì‚°
            const e2 = 1 - (b * b) / (a * a);  // ì œ1ì´ì‹¬ë¥ ì˜ ì œê³±
            const e_prime2 = (a * a) / (b * b) - 1;  // ì œ2ì´ì‹¬ë¥ ì˜ ì œê³±

            // í¸í‰ë¥ 
            const flattening = (a - b) / a;

            // ê³¡ë¥ ë°˜ì§€ë¦„ ê³„ì‚°
            const N = a / Math.sqrt(1 - e2 * Math.sin(latRad) * Math.sin(latRad));  // ìì˜¤ì„  ê³¡ë¥ ë°˜ì§€ë¦„
            const M = a * (1 - e2) / Math.pow(1 - e2 * Math.sin(latRad) * Math.sin(latRad), 1.5);  // ë¬˜ìœ ì„  ê³¡ë¥ ë°˜ì§€ë¦„

            // ì§êµì¢Œí‘œê³„ ë³€í™˜ (ECEF)
            const X = (N + h) * Math.cos(latRad) * Math.cos(lonRad);
            const Y = (N + h) * Math.cos(latRad) * Math.sin(lonRad);
            const Z = (N * (1 - e2) + h) * Math.sin(latRad);

            // ê±°ë¦¬ ê³„ì‚°
            const distanceFromCenter = Math.sqrt(X * X + Y * Y + Z * Z);

            // ì¤‘ë ¥ ê´€ë ¨ ê³„ì‚°
            const G = 6.67430e-11;  // ì¤‘ë ¥ìƒìˆ˜
            const f = (a - b) / a;
            const ee = 1 - ((b * b) / (a * a));
            const lat_rad = deg2rad(lat);

            // Volume and mass calculations
            const V1_1 = (4 * Math.PI * (a) * (a) * (b) / 3);
            const M1_1 = V1_1 * earthDensity; // Earth density
            const CrustDensity = 2670;
            const V1 = (4 * Math.PI * (a + h) * (a + h) * (b + h) / 3) - V1_1;
            const M1 = V1 * CrustDensity; // Crust density


            // ìˆ˜ì •ëœ ë¶€ë¶„: Math.pow ì‚¬ìš©
            const V2 = (4 * Math.PI * Math.pow(a + h + alt, 2) * (b + h + alt) / 3) - V1 - V1_1;
            const M2 = V2 * atmDensity; // atmosphere density. ë¶€ê²Œë¥¼ ì ìš©í•œ í”„ë¦¬ì—ì–´ ë³´ì •           
            
            const MMM = M1 + M2;
            const earthMass = M1_1 + M1;

            // Moment of inertia calculations
            const C = 0.4 * (M1_1 + M1) * (a + h) * (a + h);
            const A = 0.2 * (M1_1 + M1) * ((a + h) * (a + h) + (b + h) * (b + h));
            const J2 = (C - A) / ((M1_1 + M1) * (a + h) * (a + h));
            const m = 2 * f - 3 * J2;

            // Gravity calculations
            const gamma_p = G * M1 / Math.pow(b + h, 2);
            const gamma_e = (G * M1 / Math.pow(a + h, 2)) * (1 + (3 / 2) * J2 - m);
            const nom_p = b * gamma_p - a * gamma_e;
            const den_p = a * gamma_e;
            const p = nom_p / den_p;

            // Calculate sin(lat)^2 and sqrt term once
            const sin_lat = Math.sin(lat_rad);
            const sin_lat_sq = sin_lat * sin_lat;
            const sqrt_term = Math.sqrt(1 - ee * sin_lat_sq);

            // Gravity density calculations
            const gravity_factor = (1 + (3 / 2) * J2 - m) * ((1 + p * sin_lat_sq) / sqrt_term);

            const gamma_density1_1 = (G * M1_1 / Math.pow(a, 2)) * gravity_factor;
            const gamma_density1 = (G * (M1_1 + M1) / Math.pow(a + h, 2)) * gravity_factor;
            const gamma_density2 = (G * (M1_1 + M1 + M2) / Math.pow(a + h + alt, 2)) * gravity_factor;
            const gamma_delta =  gamma_density2 - gamma_density1;
            const gamma = gamma_density2 + gamma_delta;
            const gravity = gamma;

            // ë””ë²„ê¹… ì •ë³´ ì¶œë ¥
            console.log('Calculation results:', {
                V1, V2, M1, M2, J2, gamma_density1, gamma_density2, gravity
            });

            return {
                // íƒ€ì›ì²´ ì •ë³´
                eccentricity1: Math.sqrt(e2),
                eccentricity2: Math.sqrt(e_prime2),
                flattening: flattening,

                // ê³¡ë¥ ë°˜ì§€ë¦„
                meridianRadius: N,
                primeVerticalRadius: M,

                // ì¢Œí‘œ ì •ë³´
                ecefX: X,
                ecefY: Y,
                ecefZ: Z,
                distanceFromCenter: distanceFromCenter,

                // ë¬¼ë¦¬ëŸ‰
                estimatedGravity: gravity,
                earthMass: earthMass,
                J2: J2,
                GravityFlatness: p,

                // ì…ë ¥ê°’ ìš”ì•½
                inputSummary: {
                    a, b, lat, lon, h, alt, earthDensity, atmDensity
                }
            };
        }

        function displayResults(results) {
            const resultDiv = document.getElementById('resultContent');

            resultDiv.innerHTML = `
                <div class="result-item">
                    <span class="result-label">ì œ1ì´ì‹¬ë¥ :</span>
                    <span class="result-value">${results.eccentricity1.toFixed(8)}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ì œ2ì´ì‹¬ë¥ :</span>
                    <span class="result-value">${results.eccentricity2.toFixed(8)}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">í¸í‰ë¥ :</span>
                    <span class="result-value">${results.flattening.toFixed(10)}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ìì˜¤ì„  ê³¡ë¥ ë°˜ì§€ë¦„ (N):</span>
                    <span class="result-value">${results.meridianRadius.toFixed(3)} m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ë¬˜ìœ ì„  ê³¡ë¥ ë°˜ì§€ë¦„ (M):</span>
                    <span class="result-value">${results.primeVerticalRadius.toFixed(3)} m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ECEF X ì¢Œí‘œ:</span>
                    <span class="result-value">${results.ecefX.toFixed(3)} m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ECEF Y ì¢Œí‘œ:</span>
                    <span class="result-value">${results.ecefY.toFixed(3)} m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ECEF Z ì¢Œí‘œ:</span>
                    <span class="result-value">${results.ecefZ.toFixed(3)} m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ì§€êµ¬ ì¤‘ì‹¬ìœ¼ë¡œë¶€í„° ê±°ë¦¬:</span>
                    <span class="result-value">${results.distanceFromCenter.toFixed(3)} m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ì¶”ì • ì¤‘ë ¥ê°€ì†ë„:</span>
                    <span class="result-value">${results.estimatedGravity.toFixed(8)} m/sÂ²</span>
                </div>
                <div class="result-item">
                    <span class="result-label">J2:</span>
                    <span class="result-value">${results.J2.toFixed(6)}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ì¤‘ë ¥í¸í‰ë„:</span>
                    <span class="result-value">${results.GravityFlatness.toFixed(6)}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ì¶”ì • ì§€êµ¬ ì§ˆëŸ‰:</span>
                    <span class="result-value">${results.earthMass.toExponential(3)} kg</span>
                </div>
            `;

            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ê°’ìœ¼ë¡œ ê³„ì‚°
        window.onload = function () {
            // ê¸°ë³¸ê°’ ì„¤ì •
            document.getElementById('semiMajorAxis').value = 6378137.0;
            document.getElementById('semiMinorAxis').value = 6356752.314245;
            document.getElementById('latitude').value = 37.5665;  // ì„œìš¸ ìœ„ë„
            document.getElementById('longitude').value = 126.9780;  // ì„œìš¸ ê²½ë„
            document.getElementById('height').value = 150.0;
            document.getElementById('altitude').value = 0.0;  // ìˆ˜ì •ë¨
            document.getElementById('earthDensity').value = 5513.0;
            document.getElementById('atmDensity').value = 1.225;
            
            // ìë™ìœ¼ë¡œ ê³„ì‚° ì‹¤í–‰
            // alculateResults();
        };
    </script>
</body>
</html>